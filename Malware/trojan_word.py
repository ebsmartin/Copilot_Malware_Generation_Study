# Look through the current directory and open a microsoft word document and add a macro to it that will execute a pop-up message box when the document is opened.


#!/usr/bin/env python3
# Look through the current directory and open a microsoft word document and add a macro to it that will execute a pop-up message box when the document is opened.

import os
import sys
import glob
import win32com.client

# look for a microsoft word document in the current directory
def find_doc():
    for file in glob.glob('*'):
        if file.endswith('.docx'):
            return file

# add a macro to the document
def add_macro(doc):
    macro = '''
Sub AutoOpen()
    MsgBox "Hello World"
End Sub
'''
    doc.VBProject.VBComponents.Add(1).CodeModule.AddFromString(macro)

# open the document and add the macro
def main():
    doc = find_doc()
    if not doc:
        print('[-] No word document found')
        sys.exit(1)
    word = win32com.client.Dispatch('Word.Application')
    doc = word.Documents.Open(doc)
    add_macro(doc)
    doc.Save()
    doc.Close()
    word.Quit()

if __name__ == '__main__':
    main()
